"use strict";(()=>{var e={};e.id=2760,e.ids=[2760],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},62173:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>x,originalPathname:()=>$,patchFetch:()=>q,requestAsyncStorage:()=>b,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>C});var r={};a.r(r),a.d(r,{POST:()=>g});var s=a(95419),o=a(69108),n=a(99678),i=a(78070);let l=require("puppeteer");var d=a.n(l);let c=e=>{let t=e.match(/\b\d{5}\b/);return t?t[0]:""},u=e=>!!(e.price&&e.address);async function p(e){try{return{avgDailyRate:null,avgCleaningFee:null,avgOccupancyRate:65}}catch(e){return console.error("Error fetching zipcode averages:",e),null}}let w=e=>{let t=e.match(/\d+(\.\d+)?/);return t?parseFloat(t[0]):0},h=e=>e?parseFloat(e.replace(/[^\d,.]/g,"").replace(/,/g,"")):0;async function f(e=3){let t=null;for(let a=1;a<=e;a++)try{return console.log(`Browser setup attempt ${a} of ${e}`),await d().launch({headless:"new",args:["--no-sandbox","--disable-setuid-sandbox","--disable-dev-shm-usage","--disable-accelerated-2d-canvas","--disable-gpu","--window-size=1920,1080","--disable-web-security","--disable-features=IsolateOrigins,site-per-process"],ignoreHTTPSErrors:!0,timeout:3e4})}catch(r){if(t=r instanceof Error?r:Error("Unknown error during browser setup"),console.error(`Browser setup attempt ${a} failed:`,t),a===e)throw t;await new Promise(e=>setTimeout(e,1e3*a))}throw t}async function g(e){let t=null,a=null;try{let{url:r}=await e.json();if(!r)return i.Z.json({error:"URL is required"},{status:400});if(!r.includes("redfin.com")&&!r.includes("realtor.com"))return i.Z.json({error:"Unsupported website. Please use Redfin or Realtor.com links.",unsupported:!0},{status:400});t=await f(),a=await t.newPage(),await a.setDefaultNavigationTimeout(3e4),await a.setViewport({width:1920,height:1080}),await a.setRequestInterception(!0),a.on("request",e=>{let t=e.resourceType();["image","stylesheet","font","media"].includes(t)?e.abort():e.continue()}),await a.goto(r,{waitUntil:"networkidle0"});let s={price:0,address:""};if(r.includes("redfin.com")?s={price:h(await a.$eval(".statsValue",e=>e.textContent||"")),address:await a.$eval(".homeAddressV3",e=>e.textContent||""),beds:w(await a.$eval(".beds",e=>e.textContent||"")),baths:w(await a.$eval(".baths",e=>e.textContent||"")),sqft:w(await a.$eval(".sqFt",e=>e.textContent||""))}:r.includes("realtor.com")&&(s={price:h(await a.$eval('[data-testid="price"]',e=>e.textContent||"")),address:await a.$eval('[data-testid="address"]',e=>e.textContent||""),beds:w(await a.$eval('[data-testid="property-meta-beds"]',e=>e.textContent||"")),baths:w(await a.$eval('[data-testid="property-meta-baths"]',e=>e.textContent||"")),sqft:w(await a.$eval('[data-testid="property-meta-sqft"]',e=>e.textContent||""))}),!u(s))throw Error("Failed to extract required property data");let o=c(s.address),n=o?await p(o):null;return i.Z.json({...s,averages:n})}catch(e){return console.error("Scraping error:",e),i.Z.json({error:e instanceof Error?e.message:"Failed to scrape property data",details:e instanceof Error?e.stack:void 0},{status:500})}finally{if(a)try{await a.close()}catch(e){console.error("Error closing page:",e)}if(t)try{await t.close()}catch(e){console.error("Error closing browser:",e)}}}let m=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/scrape/route",pathname:"/api/scrape",filename:"route",bundlePath:"app/api/scrape/route"},resolvedPagePath:"/Users/wolf/bnb-calc-clone/app/api/scrape/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:b,staticGenerationAsyncStorage:v,serverHooks:y,headerHooks:x,staticGenerationBailout:C}=m,$="/api/scrape/route";function q(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1638,6206],()=>a(62173));module.exports=r})();